
{%- if hypervisor == "kvm" %}

[DEFAULT]
compute_driver=libvirt.LibvirtDriver

[libvirt]
{%- if grains.get("virtual") != "physical" %}
virt_type = qemu
{%- else %}
virt_type = kvm
{%- endif %}

{%- if hypervisor == "nova-compute-lxc" %}
virt_type = lxc
{%- endif %}

{% if pillar.get("ceph", {}).get("enabled") %}
images_type=rbd
images_rbd_pool=openstack
images_rbd_ceph_conf=/etc/ceph/ceph.conf
rbd_user=admin
rbd_secret_uuid=ThisKeyHasToBeChanged
{%- endif %}

{%- elif hypervisor == "lxd" %}

[DEFAULT]
compute_driver=nclxd.nova.virt.lxd.LXDDriver

{%- endif %}

